{% extends "base.html" %}
{% block head %}
{{ super() }}

<script type="text/javascript">
    active_menu = "{{ result_tables[0]['id'] }}_search";
</script>
<script src="{{ url_for('static', filename='js/result.js') }}"></script>
{% endblock %}

{% block content %}
<h1 class="search-header">
    {% if 'mb' == result_tables[0]['id'] %}
    Gene Fusions Search Result
    {% else %}
    Clinical Association Search Result
    {% endif %}
</h1>
<div class="panel panel-default">
    <div class="panel-body">
        <div>
            {% for table in result_tables %}
            <div class="row float-left">
                <div class="col-md-12 backbutton-div">
                    <button class="btn btn-outline-secondary back-button"><i class="fas fa-chevron-left"
                                                                     style="margin-right: 5px;"></i>Back
                    </button>
                </div>
            </div>
            {% if table.data|length %}
            <div class="row float-right">
                <div class="col-md-12 button-div"></div>
            </div>
            <table class="table table-striped result-table" cellspacing="0" width="100%">
                <thead>
                <tr>
                    {% for header in table.headers %}
                    <th>{{ header }}</th>
                    {% endfor %}
                </tr>
                </thead>
                <tbody>
                {% for row in table.data %}
                <tr>
                    <td>{{ row.MorphName if row.MorphName }}</td>
                    <td>{{ row.TopoName if row.TopoName }}</td>
                    <td>{{ row.KaryShort if row.KaryShort }}</td>
                    <td>
                        {% set gene_items = row.GeneShort.split(',') if row.GeneShort%}
                        {% for gene_item in gene_items %}
                            {% if loop.index > 1 %}
                            <br>
                            {% endif %}
                        {% set genes = gene_item.split('/') %}
                        {% for gene in genes %}{{ '/' if loop.index > 1}}<a target="_blank" href="https://www.ncbi.nlm.nih.gov/gene/?term={{gene}}">{{ gene }}</a>{% endfor %}
                        {% endfor %}
                    </td>
                    {#
                    <td>{{ row.GeneShort if row.GeneShort }}</td>
                    #}
                    <td>
                        {% if row.Immunology and row.Immunology != ' '%}
                        {{ row.Immunology }}-Lineage
                        {% endif %}
                    </td>
                    <td>
                        <a href="{{ url_for('ref_details', refno=row.RefNo) }}">{{ row.Abbreviation }}, {{ row.Journal }}</a>
                    </td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
            {% elif table.msg %}
            <div class="row">
                <div class="col-md-12 text-center"><strong>{{ table.msg|safe }}</strong>
                </div>
            </div>
            {% else %}
            <div class="row">
                <div class="col-md-12 text-center"><strong>No Results Matched Your Search Criteria</strong>
                </div>
            </div>
            {% endif %}
            {% endfor %}
        </div>
    </div>
</div>

{% endblock %}
